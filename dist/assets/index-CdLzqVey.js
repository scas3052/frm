import{i as y,g as I,a as w}from"./firebase-5PoX6OMS.js";import{createUserWithEmailAndPassword as b,signInWithEmailAndPassword as v,GoogleAuthProvider as P,signInWithPopup as E}from"https://www.gstatic.com/firebasejs/10.11.1/firebase-auth.js";import{doc as d,setDoc as u,getDoc as U}from"https://www.gstatic.com/firebasejs/10.11.1/firebase-firestore.js";(function(){const o=document.createElement("link").relList;if(o&&o.supports&&o.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))a(s);new MutationObserver(s=>{for(const e of s)if(e.type==="childList")for(const n of e.addedNodes)n.tagName==="LINK"&&n.rel==="modulepreload"&&a(n)}).observe(document,{childList:!0,subtree:!0});function t(s){const e={};return s.integrity&&(e.integrity=s.integrity),s.referrerPolicy&&(e.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?e.credentials="include":s.crossOrigin==="anonymous"?e.credentials="omit":e.credentials="same-origin",e}function a(s){if(s.ep)return;s.ep=!0;const e=t(s);fetch(s.href,e)}})();const N={apiKey:"AIzaSyDqfO7C2jAeFCeggWoDDwnP6Mi0KQF4xCE",authDomain:"haftrail.firebaseapp.com",projectId:"haftrail",storageBucket:"haftrail.firebasestorage.app",messagingSenderId:"308714739048",appId:"1:308714739048:web:ec3732457c4fac96f372dd"},g=y(N),m=I(g),c=w(g);function r(i,o,t=!1){var a=document.getElementById(o);a.style.display="block",a.innerHTML=i,a.style.opacity=1,a.style.backgroundColor=t?"var(--auth-success)":"var(--auth-error)",setTimeout(function(){a.style.opacity=0},5e3)}const M=document.getElementById("submitSignUp");M.addEventListener("click",i=>{i.preventDefault();const o=document.getElementById("rEmail").value,t=document.getElementById("rPassword").value,a=document.getElementById("fName").value,s=document.getElementById("lName").value,e=document.getElementById("mobileNumber").value;if(!/^\d{10}$/.test(e)){r("Please enter a valid 10-digit mobile number","signUpMessage");return}b(c,o,t).then(n=>{const l=n.user,f={email:o,firstName:a,lastName:s,phone:e};r("Account Created Successfully","signUpMessage",!0);const h=d(m,"users",l.uid);return u(h,f).then(()=>{setTimeout(()=>{sessionStorage.setItem("loggedInUserId",l.uid),window.location.href="homepage.html"},1e3)})}).catch(n=>{const l=n.code;l=="auth/email-already-in-use"?r("Email Address Already Exists","signUpMessage"):r(l==="auth/invalid-email"?"Please enter a valid email address":l==="auth/weak-password"?"Password should be at least 6 characters":"Unable to create account. Please try again.","signUpMessage")})});const S=document.getElementById("submitSignIn");S.addEventListener("click",i=>{i.preventDefault();const o=document.getElementById("email").value,t=document.getElementById("password").value;v(c,o,t).then(a=>{const s=a.user;r("Login successful","signInMessage",!0),setTimeout(()=>{sessionStorage.setItem("loggedInUserId",s.uid),window.location.href="homepage.html"},1e3)}).catch(a=>{const s=a.code;let e;switch(s){case"auth/invalid-email":e="Please enter a valid email address";break;case"auth/user-disabled":e="This account has been disabled";break;case"auth/user-not-found":e="No account exists with this email. Please sign up first.";break;case"auth/wrong-password":e="Incorrect password. Please try again.";break;case"auth/invalid-login-credentials":e="No account exists with this email. Please sign up first.";break;case"auth/invalid-credential":e="Invalid credentials. Please check your email and password.";break;case"auth/missing-password":e="Please enter your password";break;default:e="Login failed. Please try again."}r(e,"signInMessage")})});const L=new P,A=document.getElementById("googleSignIn");A.addEventListener("click",()=>{p("signInMessage")});const k=document.getElementById("googleSignUp");k.addEventListener("click",()=>{p("signUpMessage")});async function p(i){try{const t=(await E(c,L)).user,a=d(m,"users",t.uid);if((await U(a)).exists())r("Login successful",i,!0),setTimeout(()=>{sessionStorage.setItem("loggedInUserId",t.uid),window.location.href="homepage.html"},1e3);else{const e=t.displayName?t.displayName.split(" "):["User",""],n={email:t.email,firstName:e[0],lastName:e.slice(1).join(" "),photoURL:t.photoURL||null};await u(a,n),r("Account Created Successfully",i,!0),sessionStorage.setItem("loggedInUserId",t.uid),sessionStorage.setItem("needsMobileNumber","true"),setTimeout(()=>{window.location.href="profile.html"},1e3)}}catch(o){console.error("Google auth error:",o);let t="Authentication failed. Please try again.";o.code==="auth/popup-closed-by-user"?t="Sign in was cancelled.":o.code==="auth/popup-blocked"&&(t="Pop-up was blocked by your browser. Please allow pop-ups for this site."),r(t,i)}}
